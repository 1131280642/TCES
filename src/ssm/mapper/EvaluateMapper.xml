<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ssm.dao.EvaluateDao">

	<!-- 1.通过学生班级号，查询相应班级的课程名，任课老师 -->
	<select id="selectCourseTeacherByNo" parameterType="String" resultMap="teacher_course">
		select teacher_course.*,course.course_name,teacher.teacher_name 
		from teacher_course,course,classes,teacher
		where teacher_course.teacher_id=teacher.id
		and teacher_course.course_id=course.id
		and teacher_course.classes_id=classes.id
		and classes.classes_no=#{classes.classes_no};
	</select>
	
	<resultMap type="ssm.entity.Teacher_course" id="teacher_course">
		<id property="id" column="id" />
		<result property="teacher_id" column="teacher_id" />
		<result property="classes_id" column="classes_id" />
		<result property="course_id" column="course_id" />
		<result property="term_id" column="term_id" />
		<association property="teacher" javaType="ssm.entity.Teacher">
			<id property="id" column="id" />
			<result property="teacher_name" column="teacher_name" />
		</association>
		<association property="course" javaType="ssm.entity.Course">
			<id property="id" column="id" />
			<result property="course_name" column="course_name" />
		</association>
		<association property="department" javaType="ssm.entity.Department">
			<id property="id" column="id" />
			<result property="dep_name" column="dep_name" />
		</association>
	</resultMap>
	
	<resultMap type="ssm.entity.Teacher_course" id="teacher_courseAll">
		<id property="id" column="id" />
		<result property="teacher_id" column="teacher_id" />
		<result property="classes_id" column="classes_id" />
		<result property="course_id" column="course_id" />
		<result property="term_id" column="term_id" />
		<association property="teacher" javaType="ssm.entity.Teacher">
			<id property="id" column="id" />
			<result property="teacher_no" column="teacher_no" />
			<result property="teacher_name" column="teacher_name" />
			<result property="teacher_pwd" column="teacher_pwd" />
			<result property="sex" column="sex" />
			<result property="tel" column="tel" />
			<result property="dep_id" column="dep_id" />
			<result property="time" column="time" />
			<result property="remark" column="remark" />
			<result property="is_manage" column="is_manage" />
		</association>
		<association property="classes" javaType="ssm.entity.Classes">
			<id property="id" column="id" />
			<result property="classes_no" column="classes_no" />
			<result property="dep_id" column="dep_id" />
		</association>
		<association property="course" javaType="ssm.entity.Course">
			<id property="id" column="id" />
			<result property="course_name" column="course_name" />
			<result property="dep_id" column="dep_id" />
		</association>
		<association property="term" javaType="ssm.entity.Term">
			<id property="id" column="id" />
			<result property="term_name" column="term_name" />
			<result property="is_open" column="is_open" />
		</association>
	</resultMap>
	
	
	<!-- 2.通过教师的部门号，查询改部门的课程名和相应任课教师名 -->
	<select id="selectCourseTeacherByDepid" parameterType="int" resultMap="teacher_course">
		select course.course_name,teacher.teacher_name 
		from course,teacher,teacher_course,department
		where teacher_course.course_id=course.id
		and teacher_course.teacher_id=teacher.id
		and department.id=teacher.dep_id
		and department.id=#{department.id};
	</select>
	
	<!-- 3.学生评价教师的信息插入 -->
	<insert id="InsertSt_score" parameterType="int">
		insert into st_score (student_id,classes_id,teacher_id,st_score,course_name)
		values (#{student_id},#{classes_id},#{teacher_id},#{st_score},#{course_name})
	</insert>
	
	<!-- 4.教师评价教师的信息插入 -->
	<insert id="InsertTt_score" parameterType="int">
		insert into tt_score (teacher1_id,dep_id,teacher2_id,tt_score,course_name)
		values (#{teacher1_id},#{dep_id},#{teacher2_id},#{tt_score},#{course_name})
	</insert>
	
	<!-- 1.通过授课号，查询相应班级的课程名，任课老师 -->
	<select id="selectCourseTeacherAllById" parameterType="int" resultMap="teacher_courseAll">
		select teacher.*,classes.*,course.*,term.*
		from teacher_course,teacher,classes,course,term
		where teacher_course.teacher_id=teacher.id and teacher_course.classes_id=classes.id
		and teacher_course.course_id=course.id and teacher_course.term_id=term.id
		and teacher_course.id=#{id};
	</select>
	
	<!-- 5.通过学生评教列表id，查询信息 -->
	<select id="selectCourseTeacherByid" parameterType="int" resultMap="teacher_course">
		select teacher_course.*,course.course_name,teacher.teacher_name 
		from teacher_course,course,classes,teacher
		where teacher_course.teacher_id=teacher.id
		and teacher_course.course_id=course.id
		and teacher_course.classes_id=classes.id
		and teacher_course.id=#{id};
	</select>
	
	<insert id="insertSt_scoreInfo" parameterType="ssm.entity.St_score" > 
		insert into st_score(student_id,classes_id,teacher_id,st_score,course_name) values 
		(#{student_id},#{classes_id},#{teacher_id},#{st_score},#{course_name});
	</insert>
</mapper>